<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>calorie.service.ts - Detailed Analysis</title>
<style>
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; background-color: #f5f5f5; }
.container { max-width: 1000px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
.header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #007acc; }
.header h1 { color: #007acc; margin: 0; font-size: 2.2em; }
.back-link { display: inline-block; margin-bottom: 20px; color: #007acc; text-decoration: none; font-weight: bold; }
.back-link:hover { text-decoration: underline; }
.summary-card { background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 30px; border-left: 4px solid #007acc; }
.score-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin: 20px 0; }
.score-item { background: white; padding: 15px; border-radius: 6px; text-align: center; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
.score-value { font-size: 1.8em; font-weight: bold; color: #007acc; }
.score-label { color: #666; margin-top: 5px; font-size: 0.9em; }
.analysis-section { margin: 30px 0; padding: 20px; background: #fafafa; border-radius: 8px; border: 1px solid #e0e0e0; }
.analysis-section h2 { color: #333; margin-bottom: 15px; border-bottom: 2px solid #007acc; padding-bottom: 8px; }
.reasoning-text { color: #555; line-height: 1.6; margin-bottom: 15px; padding: 15px; background: white; border-radius: 6px; border-left: 3px solid #007acc; }
.recommendations { margin-top: 20px; }
.recommendations h3 { color: #007acc; margin-bottom: 10px; }
.recommendations ul { margin: 0; padding-left: 25px; }
.recommendations li { margin: 8px 0; color: #555; line-height: 1.5; display: flex; justify-content: space-between; align-items: flex-start; }
.recommendation-text { flex: 1; margin-right: 10px; }
.fix-button { background: linear-gradient(45deg, #007acc, #005999); color: white; border: none; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 0.8em; font-weight: bold; transition: all 0.3s ease; white-space: nowrap; }
.fix-button:hover { background: linear-gradient(45deg, #005999, #003d73); transform: translateY(-1px); box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
.fix-button:active { transform: translateY(0); }
.fix-button:disabled { background: #ccc; cursor: not-allowed; transform: none; }
.fix-status { margin-left: 5px; font-size: 0.8em; }
.fix-success { color: #28a745; }
.fix-error { color: #dc3545; }
.fix-loading { color: #ffc107; }
.metrics-section { margin: 30px 0; }
.metrics-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
.metrics-table th, .metrics-table td { padding: 10px; text-align: left; border-bottom: 1px solid #ddd; }
.metrics-table th { background-color: #007acc; color: white; }
.quality-indicator { padding: 5px 10px; border-radius: 4px; color: white; font-weight: bold; text-align: center; }
.quality-green { background-color: #28a745; }
.quality-yellow { background-color: #ffc107; color: black; }
.quality-red { background-color: #dc3545; }
.final-score { font-size: 2.5em; font-weight: bold; color: #007acc; text-align: center; margin: 20px 0; }
</style>
<script>
function fixWithAI(category, recommendation, button) {
    const originalText = button.textContent;
    button.disabled = true;
    button.textContent = 'Fixing...';
    button.style.background = '#ffc107';
    
    // Create status indicator
    const statusSpan = document.createElement('span');
    statusSpan.className = 'fix-status fix-loading';
    statusSpan.textContent = ' ⏳';
    button.parentNode.appendChild(statusSpan);
    
    // Simulate AI processing (replace with actual API call)
    setTimeout(() => {
        // For demo purposes, randomly succeed or fail
        const success = Math.random() > 0.3;
        
        if (success) {
            button.textContent = 'Fixed ✓';
            button.style.background = '#28a745';
            statusSpan.className = 'fix-status fix-success';
            statusSpan.textContent = ' Applied';
            
            // Show success message
            showNotification('Fix applied successfully for: ' + category, 'success');
        } else {
            button.textContent = 'Retry';
            button.style.background = '#dc3545';
            button.disabled = false;
            statusSpan.className = 'fix-status fix-error';
            statusSpan.textContent = ' Failed';
            
            // Show error message
            showNotification('Failed to apply fix. Please try again.', 'error');
        }
    }, 2000 + Math.random() * 3000); // 2-5 second delay
}

function showNotification(message, type) {
    const notification = document.createElement('div');
    notification.style.cssText = `
        position: fixed; top: 20px; right: 20px; z-index: 1000;
        padding: 12px 20px; border-radius: 6px; color: white;
        font-weight: bold; box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        transform: translateX(100%); transition: transform 0.3s ease;
        background: ${type === 'success' ? '#28a745' : '#dc3545'};
    `;
    notification.textContent = message;
    document.body.appendChild(notification);
    
    // Slide in
    setTimeout(() => notification.style.transform = 'translateX(0)', 100);
    
    // Slide out and remove
    setTimeout(() => {
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => document.body.removeChild(notification), 300);
    }, 4000);
}
</script>
</head>
<body>
<div class="container">
<a href="../technical-report.html" class="back-link">← Back to Technical Report</a>
<div class="header">
<h1>calorie.service.ts</h1>
<p>Detailed Code Analysis Results</p>
</div>
<div class="summary-card">
<div class="final-score">76.8</div>
<div style="text-align: center;">
<span class="quality-indicator quality-yellow">Medium Quality</span></div></div>
<div class="score-grid">
<div class="score-item">
<div class="score-value">85.0</div>
<div class="score-label">Code Quality</div>
</div>
<div class="score-item">
<div class="score-value">70.0</div>
<div class="score-label">SOLID Principles</div>
</div>
<div class="score-item">
<div class="score-value">90.0</div>
<div class="score-label">Design Patterns</div>
</div>
<div class="score-item">
<div class="score-value">90.0</div>
<div class="score-label">Security</div>
</div>
<div class="score-item">
<div class="score-value">50.0</div>
<div class="score-label">Bug Detection</div>
</div>
</div>
<div class="analysis-section">
<h2>Code Quality Analysis (85.0/100)</h2>
<div class="reasoning-text">The code is well-structured and follows good practices of TypeScript and NestJS. However, it lacks comments and documentation which makes it harder to understand the purpose of each function and the overall service.</div>
<div class="recommendations">
<h3>Recommendations</h3>
<ul>
<li><span class="recommendation-text">Add comments to describe the purpose of each function and the overall service.</span><button class="fix-button" id="fix-code-quality-analysis-0" onclick="fixWithAI('Code Quality Analysis', 'Add comments to describe the purpose of each function and the overall service.', this)" data-category="Code Quality Analysis" data-recommendation="Add comments to describe the purpose of each function and the overall service.">Fix with AI</button></li>
<li><span class="recommendation-text">Consider breaking down the &#39;addTestData&#39; function into smaller functions to improve readability and maintainability.</span><button class="fix-button" id="fix-code-quality-analysis-1" onclick="fixWithAI('Code Quality Analysis', 'Consider breaking down the &#39;addTestData&#39; function into smaller functions to improve readability and maintainability.', this)" data-category="Code Quality Analysis" data-recommendation="Consider breaking down the &#39;addTestData&#39; function into smaller functions to improve readability and maintainability.">Fix with AI</button></li>
<li><span class="recommendation-text">Add error handling for potential failures of the repository operations.</span><button class="fix-button" id="fix-code-quality-analysis-2" onclick="fixWithAI('Code Quality Analysis', 'Add error handling for potential failures of the repository operations.', this)" data-category="Code Quality Analysis" data-recommendation="Add error handling for potential failures of the repository operations.">Fix with AI</button></li>
<li><span class="recommendation-text">Consider using constants for magic numbers and strings used in the code.</span><button class="fix-button" id="fix-code-quality-analysis-3" onclick="fixWithAI('Code Quality Analysis', 'Consider using constants for magic numbers and strings used in the code.', this)" data-category="Code Quality Analysis" data-recommendation="Consider using constants for magic numbers and strings used in the code.">Fix with AI</button></li>
<li><span class="recommendation-text">Consider adding type annotations for function return types for better readability and type safety.</span><button class="fix-button" id="fix-code-quality-analysis-4" onclick="fixWithAI('Code Quality Analysis', 'Consider adding type annotations for function return types for better readability and type safety.', this)" data-category="Code Quality Analysis" data-recommendation="Consider adding type annotations for function return types for better readability and type safety.">Fix with AI</button></li>
</ul></div>
</div>
<div class="analysis-section">
<h2>SOLID Principles Analysis (70.0/100)</h2>
<div class="reasoning-text">The CalorieService class is mostly adhering to the Single Responsibility Principle, but the &#39;addTestData&#39; method is doing too much and is not related to the main responsibility of the class.</div>
<div class="recommendations">
<h3>Recommendations</h3>
<ul>
<li><span class="recommendation-text">The &#39;addTestData&#39; method should be moved to a separate class or service that is responsible for generating test data.</span><button class="fix-button" id="fix-solid-principles-analysis-0" onclick="fixWithAI('SOLID Principles Analysis', 'The &#39;addTestData&#39; method should be moved to a separate class or service that is responsible for generating test data.', this)" data-category="SOLID Principles Analysis" data-recommendation="The &#39;addTestData&#39; method should be moved to a separate class or service that is responsible for generating test data.">Fix with AI</button></li>
<li><span class="recommendation-text">The &#39;addTestData&#39; method could be broken down into smaller methods each with a single responsibility, such as generating random food names, generating random dates, and generating random calorie counts.</span><button class="fix-button" id="fix-solid-principles-analysis-1" onclick="fixWithAI('SOLID Principles Analysis', 'The &#39;addTestData&#39; method could be broken down into smaller methods each with a single responsibility, such as generating random food names, generating random dates, and generating random calorie counts.', this)" data-category="SOLID Principles Analysis" data-recommendation="The &#39;addTestData&#39; method could be broken down into smaller methods each with a single responsibility, such as generating random food names, generating random dates, and generating random calorie counts.">Fix with AI</button></li>
<li><span class="recommendation-text">Consider creating a separate &#39;TestDataService&#39; or &#39;TestDataGenerator&#39; class that can be used across different services.</span><button class="fix-button" id="fix-solid-principles-analysis-2" onclick="fixWithAI('SOLID Principles Analysis', 'Consider creating a separate &#39;TestDataService&#39; or &#39;TestDataGenerator&#39; class that can be used across different services.', this)" data-category="SOLID Principles Analysis" data-recommendation="Consider creating a separate &#39;TestDataService&#39; or &#39;TestDataGenerator&#39; class that can be used across different services.">Fix with AI</button></li>
<li><span class="recommendation-text">The &#39;addTestData&#39; method could be made more generic so that it can generate test data for any entity, not just calories.</span><button class="fix-button" id="fix-solid-principles-analysis-3" onclick="fixWithAI('SOLID Principles Analysis', 'The &#39;addTestData&#39; method could be made more generic so that it can generate test data for any entity, not just calories.', this)" data-category="SOLID Principles Analysis" data-recommendation="The &#39;addTestData&#39; method could be made more generic so that it can generate test data for any entity, not just calories.">Fix with AI</button></li>
<li><span class="recommendation-text">Consider using a library or tool specifically designed for generating test data.</span><button class="fix-button" id="fix-solid-principles-analysis-4" onclick="fixWithAI('SOLID Principles Analysis', 'Consider using a library or tool specifically designed for generating test data.', this)" data-category="SOLID Principles Analysis" data-recommendation="Consider using a library or tool specifically designed for generating test data.">Fix with AI</button></li>
</ul></div>
</div>
<div class="analysis-section">
<h2>Design Patterns Analysis (90.0/100)</h2>
<div class="reasoning-text">The code is well-structured and follows the Repository pattern, which is a good choice for data access. However, there is a lack of error handling and the addTestData method seems to be for testing purposes and should not be part of the production code.</div>
<div class="recommendations">
<h3>Recommendations</h3>
<ul>
<li><span class="recommendation-text">Add error handling for database operations to prevent potential crashes or unexpected behavior.</span><button class="fix-button" id="fix-design-patterns-analysis-0" onclick="fixWithAI('Design Patterns Analysis', 'Add error handling for database operations to prevent potential crashes or unexpected behavior.', this)" data-category="Design Patterns Analysis" data-recommendation="Add error handling for database operations to prevent potential crashes or unexpected behavior.">Fix with AI</button></li>
<li><span class="recommendation-text">Consider moving the addTestData method to a separate testing or seeding script, as it does not seem to be part of the core functionality of the CalorieService.</span><button class="fix-button" id="fix-design-patterns-analysis-1" onclick="fixWithAI('Design Patterns Analysis', 'Consider moving the addTestData method to a separate testing or seeding script, as it does not seem to be part of the core functionality of the CalorieService.', this)" data-category="Design Patterns Analysis" data-recommendation="Consider moving the addTestData method to a separate testing or seeding script, as it does not seem to be part of the core functionality of the CalorieService.">Fix with AI</button></li>
<li><span class="recommendation-text">Consider using a service layer to handle business logic, such as the calculations in the getCaloriesByDay method, to keep the repository layer focused on data access.</span><button class="fix-button" id="fix-design-patterns-analysis-2" onclick="fixWithAI('Design Patterns Analysis', 'Consider using a service layer to handle business logic, such as the calculations in the getCaloriesByDay method, to keep the repository layer focused on data access.', this)" data-category="Design Patterns Analysis" data-recommendation="Consider using a service layer to handle business logic, such as the calculations in the getCaloriesByDay method, to keep the repository layer focused on data access.">Fix with AI</button></li>
<li><span class="recommendation-text">Consider using constants or configuration for values like the date format in getCaloriesByDay, to make the code more maintainable and flexible.</span><button class="fix-button" id="fix-design-patterns-analysis-3" onclick="fixWithAI('Design Patterns Analysis', 'Consider using constants or configuration for values like the date format in getCaloriesByDay, to make the code more maintainable and flexible.', this)" data-category="Design Patterns Analysis" data-recommendation="Consider using constants or configuration for values like the date format in getCaloriesByDay, to make the code more maintainable and flexible.">Fix with AI</button></li>
<li><span class="recommendation-text">Consider adding type annotations to the return values of the methods for better type safety and readability.</span><button class="fix-button" id="fix-design-patterns-analysis-4" onclick="fixWithAI('Design Patterns Analysis', 'Consider adding type annotations to the return values of the methods for better type safety and readability.', this)" data-category="Design Patterns Analysis" data-recommendation="Consider adding type annotations to the return values of the methods for better type safety and readability.">Fix with AI</button></li>
</ul></div>
</div>
<div class="analysis-section">
<h2>Security Analysis (90.0/100)</h2>
<div class="reasoning-text">The code is generally secure, using parameterized queries to prevent SQL injection and checking user permissions before performing actions. However, it lacks error handling and logging, which could lead to unhandled exceptions and lack of traceability.</div>
<div class="recommendations">
<h3>Recommendations</h3>
<ul>
<li><span class="recommendation-text">Add try-catch blocks around database operations to handle potential errors and prevent application crashes.</span><button class="fix-button" id="fix-security-analysis-0" onclick="fixWithAI('Security Analysis', 'Add try-catch blocks around database operations to handle potential errors and prevent application crashes.', this)" data-category="Security Analysis" data-recommendation="Add try-catch blocks around database operations to handle potential errors and prevent application crashes.">Fix with AI</button></li>
<li><span class="recommendation-text">Implement logging to keep track of application behavior and help with debugging.</span><button class="fix-button" id="fix-security-analysis-1" onclick="fixWithAI('Security Analysis', 'Implement logging to keep track of application behavior and help with debugging.', this)" data-category="Security Analysis" data-recommendation="Implement logging to keep track of application behavior and help with debugging.">Fix with AI</button></li>
<li><span class="recommendation-text">Consider using a validation library or built-in decorators to validate incoming data before using it.</span><button class="fix-button" id="fix-security-analysis-2" onclick="fixWithAI('Security Analysis', 'Consider using a validation library or built-in decorators to validate incoming data before using it.', this)" data-category="Security Analysis" data-recommendation="Consider using a validation library or built-in decorators to validate incoming data before using it.">Fix with AI</button></li>
<li><span class="recommendation-text">Use a centralized error handling middleware to handle all errors in one place.</span><button class="fix-button" id="fix-security-analysis-3" onclick="fixWithAI('Security Analysis', 'Use a centralized error handling middleware to handle all errors in one place.', this)" data-category="Security Analysis" data-recommendation="Use a centralized error handling middleware to handle all errors in one place.">Fix with AI</button></li>
<li><span class="recommendation-text">Consider using a rate limiting middleware to prevent brute force and denial of service attacks.</span><button class="fix-button" id="fix-security-analysis-4" onclick="fixWithAI('Security Analysis', 'Consider using a rate limiting middleware to prevent brute force and denial of service attacks.', this)" data-category="Security Analysis" data-recommendation="Consider using a rate limiting middleware to prevent brute force and denial of service attacks.">Fix with AI</button></li>
</ul></div>
</div>
<div class="analysis-section">
<h2>Bug Detection Analysis (50.0/100)</h2>
<div class="reasoning-text">Unable to analyze - using default score</div>
</div>
<div class="metrics-section">
<h2>File Metrics</h2>
<table class="metrics-table">
<tr><th>Metric</th><th>Value</th></tr>
<tr><td>Comment ratio</td><td>0.0</td></tr>
<tr><td>Lines of code</td><td>0</td></tr>
<tr><td>Number of methods</td><td>0</td></tr>
<tr><td>Number of classes</td><td>0</td></tr>
<tr><td>Cyclomatic complexity</td><td>0</td></tr>
<tr><td>Code complexity</td><td>UNKNOWN</td></tr>
</table></div>
<div style="text-align: center; margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; color: #666;">
<p>Analysis generated on 2025-08-03 12:58:17 by Code Guard</p>
<a href="../technical-report.html" class="back-link">← Back to Technical Report</a>
</div>
</div>
</body>
</html>
