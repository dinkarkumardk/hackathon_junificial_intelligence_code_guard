<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>current-user.decorator.ts - Detailed Analysis</title>
<style>
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; background-color: #f5f5f5; }
.container { max-width: 1000px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
.header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #007acc; }
.header h1 { color: #007acc; margin: 0; font-size: 2.2em; }
.back-link { display: inline-block; margin-bottom: 20px; color: #007acc; text-decoration: none; font-weight: bold; }
.back-link:hover { text-decoration: underline; }
.summary-card { background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 30px; border-left: 4px solid #007acc; }
.score-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin: 20px 0; }
.score-item { background: white; padding: 15px; border-radius: 6px; text-align: center; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
.score-value { font-size: 1.8em; font-weight: bold; color: #007acc; }
.score-label { color: #666; margin-top: 5px; font-size: 0.9em; }
.analysis-section { margin: 30px 0; padding: 20px; background: #fafafa; border-radius: 8px; border: 1px solid #e0e0e0; }
.analysis-section h2 { color: #333; margin-bottom: 15px; border-bottom: 2px solid #007acc; padding-bottom: 8px; }
.reasoning-text { color: #555; line-height: 1.6; margin-bottom: 15px; padding: 15px; background: white; border-radius: 6px; border-left: 3px solid #007acc; }
.recommendations { margin-top: 20px; }
.recommendations h3 { color: #007acc; margin-bottom: 10px; }
.recommendations ul { margin: 0; padding-left: 25px; }
.recommendations li { margin: 8px 0; color: #555; line-height: 1.5; display: flex; justify-content: space-between; align-items: flex-start; }
.recommendation-text { flex: 1; margin-right: 10px; }
.fix-button { background: linear-gradient(45deg, #007acc, #005999); color: white; border: none; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 0.8em; font-weight: bold; transition: all 0.3s ease; white-space: nowrap; }
.fix-button:hover { background: linear-gradient(45deg, #005999, #003d73); transform: translateY(-1px); box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
.fix-button:active { transform: translateY(0); }
.fix-button:disabled { background: #ccc; cursor: not-allowed; transform: none; }
.fix-status { margin-left: 5px; font-size: 0.8em; }
.fix-success { color: #28a745; }
.fix-error { color: #dc3545; }
.fix-loading { color: #ffc107; }
.metrics-section { margin: 30px 0; }
.metrics-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
.metrics-table th, .metrics-table td { padding: 10px; text-align: left; border-bottom: 1px solid #ddd; }
.metrics-table th { background-color: #007acc; color: white; }
.quality-indicator { padding: 5px 10px; border-radius: 4px; color: white; font-weight: bold; text-align: center; }
.quality-green { background-color: #28a745; }
.quality-yellow { background-color: #ffc107; color: black; }
.quality-red { background-color: #dc3545; }
.final-score { font-size: 2.5em; font-weight: bold; color: #007acc; text-align: center; margin: 20px 0; }
</style>
<script>
function fixWithAI(category, recommendation, button) {
    const originalText = button.textContent;
    button.disabled = true;
    button.textContent = 'Fixing...';
    button.style.background = '#ffc107';
    
    // Create status indicator
    const statusSpan = document.createElement('span');
    statusSpan.className = 'fix-status fix-loading';
    statusSpan.textContent = ' ⏳';
    button.parentNode.appendChild(statusSpan);
    
    // Simulate AI processing (replace with actual API call)
    setTimeout(() => {
        // For demo purposes, randomly succeed or fail
        const success = Math.random() > 0.3;
        
        if (success) {
            button.textContent = 'Fixed ✓';
            button.style.background = '#28a745';
            statusSpan.className = 'fix-status fix-success';
            statusSpan.textContent = ' Applied';
            
            // Show success message
            showNotification('Fix applied successfully for: ' + category, 'success');
        } else {
            button.textContent = 'Retry';
            button.style.background = '#dc3545';
            button.disabled = false;
            statusSpan.className = 'fix-status fix-error';
            statusSpan.textContent = ' Failed';
            
            // Show error message
            showNotification('Failed to apply fix. Please try again.', 'error');
        }
    }, 2000 + Math.random() * 3000); // 2-5 second delay
}

function showNotification(message, type) {
    const notification = document.createElement('div');
    notification.style.cssText = `
        position: fixed; top: 20px; right: 20px; z-index: 1000;
        padding: 12px 20px; border-radius: 6px; color: white;
        font-weight: bold; box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        transform: translateX(100%); transition: transform 0.3s ease;
        background: ${type === 'success' ? '#28a745' : '#dc3545'};
    `;
    notification.textContent = message;
    document.body.appendChild(notification);
    
    // Slide in
    setTimeout(() => notification.style.transform = 'translateX(0)', 100);
    
    // Slide out and remove
    setTimeout(() => {
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => document.body.removeChild(notification), 300);
    }, 4000);
}
</script>
</head>
<body>
<div class="container">
<a href="../technical-report.html" class="back-link">← Back to Technical Report</a>
<div class="header">
<h1>current-user.decorator.ts</h1>
<p>Detailed Code Analysis Results</p>
</div>
<div class="summary-card">
<div class="final-score">88.8</div>
<div style="text-align: center;">
<span class="quality-indicator quality-green">High Quality</span></div></div>
<div class="score-grid">
<div class="score-item">
<div class="score-value">85.0</div>
<div class="score-label">Code Quality</div>
</div>
<div class="score-item">
<div class="score-value">90.0</div>
<div class="score-label">SOLID Principles</div>
</div>
<div class="score-item">
<div class="score-value">90.0</div>
<div class="score-label">Design Patterns</div>
</div>
<div class="score-item">
<div class="score-value">90.0</div>
<div class="score-label">Security</div>
</div>
<div class="score-item">
<div class="score-value">90.0</div>
<div class="score-label">Bug Detection</div>
</div>
</div>
<div class="analysis-section">
<h2>Code Quality Analysis (85.0/100)</h2>
<div class="reasoning-text">The code is concise, uses modern TypeScript features, and is generally easy to understand. However, it lacks comments and documentation, which could make it harder for other developers to understand its purpose and usage.</div>
<div class="recommendations">
<h3>Recommendations</h3>
<ul>
<li><span class="recommendation-text">Add comments to explain the purpose of the &#39;CurrentUser&#39; decorator and how it works.</span><button class="fix-button" id="fix-code-quality-analysis-0" onclick="fixWithAI('Code Quality Analysis', 'Add comments to explain the purpose of the &#39;CurrentUser&#39; decorator and how it works.', this)" data-category="Code Quality Analysis" data-recommendation="Add comments to explain the purpose of the &#39;CurrentUser&#39; decorator and how it works.">Fix with AI</button></li>
<li><span class="recommendation-text">Consider adding type annotations for the &#39;data&#39; parameter and the return type of the decorator function for better type safety.</span><button class="fix-button" id="fix-code-quality-analysis-1" onclick="fixWithAI('Code Quality Analysis', 'Consider adding type annotations for the &#39;data&#39; parameter and the return type of the decorator function for better type safety.', this)" data-category="Code Quality Analysis" data-recommendation="Consider adding type annotations for the &#39;data&#39; parameter and the return type of the decorator function for better type safety.">Fix with AI</button></li>
<li><span class="recommendation-text">Add a docstring to the &#39;CurrentUser&#39; decorator to explain what it does and what parameters it expects.</span><button class="fix-button" id="fix-code-quality-analysis-2" onclick="fixWithAI('Code Quality Analysis', 'Add a docstring to the &#39;CurrentUser&#39; decorator to explain what it does and what parameters it expects.', this)" data-category="Code Quality Analysis" data-recommendation="Add a docstring to the &#39;CurrentUser&#39; decorator to explain what it does and what parameters it expects.">Fix with AI</button></li>
<li><span class="recommendation-text">Consider handling the case where &#39;req.user&#39; is undefined or null.</span><button class="fix-button" id="fix-code-quality-analysis-3" onclick="fixWithAI('Code Quality Analysis', 'Consider handling the case where &#39;req.user&#39; is undefined or null.', this)" data-category="Code Quality Analysis" data-recommendation="Consider handling the case where &#39;req.user&#39; is undefined or null.">Fix with AI</button></li>
<li><span class="recommendation-text">Consider adding unit tests to ensure the decorator works as expected.</span><button class="fix-button" id="fix-code-quality-analysis-4" onclick="fixWithAI('Code Quality Analysis', 'Consider adding unit tests to ensure the decorator works as expected.', this)" data-category="Code Quality Analysis" data-recommendation="Consider adding unit tests to ensure the decorator works as expected.">Fix with AI</button></li>
</ul></div>
</div>
<div class="analysis-section">
<h2>SOLID Principles Analysis (90.0/100)</h2>
<div class="reasoning-text">The code is mostly adhering to the Single Responsibility Principle. The CurrentUser decorator has a single responsibility of extracting the current user from the request context.</div>
<div class="recommendations">
<h3>Recommendations</h3>
<ul>
<li><span class="recommendation-text">Consider moving the logic of switching to HTTP and getting the request to a separate function to further adhere to SRP.</span><button class="fix-button" id="fix-solid-principles-analysis-0" onclick="fixWithAI('SOLID Principles Analysis', 'Consider moving the logic of switching to HTTP and getting the request to a separate function to further adhere to SRP.', this)" data-category="SOLID Principles Analysis" data-recommendation="Consider moving the logic of switching to HTTP and getting the request to a separate function to further adhere to SRP.">Fix with AI</button></li>
<li><span class="recommendation-text">Ensure that the User entity is only responsible for user-related operations.</span><button class="fix-button" id="fix-solid-principles-analysis-1" onclick="fixWithAI('SOLID Principles Analysis', 'Ensure that the User entity is only responsible for user-related operations.', this)" data-category="SOLID Principles Analysis" data-recommendation="Ensure that the User entity is only responsible for user-related operations.">Fix with AI</button></li>
<li><span class="recommendation-text">Keep the decorator focused on extracting data from the context, not manipulating or processing it.</span><button class="fix-button" id="fix-solid-principles-analysis-2" onclick="fixWithAI('SOLID Principles Analysis', 'Keep the decorator focused on extracting data from the context, not manipulating or processing it.', this)" data-category="SOLID Principles Analysis" data-recommendation="Keep the decorator focused on extracting data from the context, not manipulating or processing it.">Fix with AI</button></li>
<li><span class="recommendation-text">Consider adding error handling for cases where the user is not found in the request.</span><button class="fix-button" id="fix-solid-principles-analysis-3" onclick="fixWithAI('SOLID Principles Analysis', 'Consider adding error handling for cases where the user is not found in the request.', this)" data-category="SOLID Principles Analysis" data-recommendation="Consider adding error handling for cases where the user is not found in the request.">Fix with AI</button></li>
<li><span class="recommendation-text">Keep the decorator and the User entity in separate modules to maintain separation of concerns.</span><button class="fix-button" id="fix-solid-principles-analysis-4" onclick="fixWithAI('SOLID Principles Analysis', 'Keep the decorator and the User entity in separate modules to maintain separation of concerns.', this)" data-category="SOLID Principles Analysis" data-recommendation="Keep the decorator and the User entity in separate modules to maintain separation of concerns.">Fix with AI</button></li>
</ul></div>
</div>
<div class="analysis-section">
<h2>Design Patterns Analysis (90.0/100)</h2>
<div class="reasoning-text">The code is well-structured and follows the decorator design pattern correctly. However, it lacks error handling which could lead to potential issues.</div>
<div class="recommendations">
<h3>Recommendations</h3>
<ul>
<li><span class="recommendation-text">Consider adding error handling for the case when &#39;req.user&#39; is undefined or null.</span><button class="fix-button" id="fix-design-patterns-analysis-0" onclick="fixWithAI('Design Patterns Analysis', 'Consider adding error handling for the case when &#39;req.user&#39; is undefined or null.', this)" data-category="Design Patterns Analysis" data-recommendation="Consider adding error handling for the case when &#39;req.user&#39; is undefined or null.">Fix with AI</button></li>
<li><span class="recommendation-text">Add comments to explain the purpose of the decorator and how it works.</span><button class="fix-button" id="fix-design-patterns-analysis-1" onclick="fixWithAI('Design Patterns Analysis', 'Add comments to explain the purpose of the decorator and how it works.', this)" data-category="Design Patterns Analysis" data-recommendation="Add comments to explain the purpose of the decorator and how it works.">Fix with AI</button></li>
<li><span class="recommendation-text">Consider adding type checking to ensure &#39;req.user&#39; is an instance of &#39;User&#39;.</span><button class="fix-button" id="fix-design-patterns-analysis-2" onclick="fixWithAI('Design Patterns Analysis', 'Consider adding type checking to ensure &#39;req.user&#39; is an instance of &#39;User&#39;.', this)" data-category="Design Patterns Analysis" data-recommendation="Consider adding type checking to ensure &#39;req.user&#39; is an instance of &#39;User&#39;.">Fix with AI</button></li>
<li><span class="recommendation-text">Consider adding unit tests to ensure the decorator works as expected.</span><button class="fix-button" id="fix-design-patterns-analysis-3" onclick="fixWithAI('Design Patterns Analysis', 'Consider adding unit tests to ensure the decorator works as expected.', this)" data-category="Design Patterns Analysis" data-recommendation="Consider adding unit tests to ensure the decorator works as expected.">Fix with AI</button></li>
<li><span class="recommendation-text">Consider using a more descriptive name for &#39;data&#39; parameter.</span><button class="fix-button" id="fix-design-patterns-analysis-4" onclick="fixWithAI('Design Patterns Analysis', 'Consider using a more descriptive name for &#39;data&#39; parameter.', this)" data-category="Design Patterns Analysis" data-recommendation="Consider using a more descriptive name for &#39;data&#39; parameter.">Fix with AI</button></li>
</ul></div>
</div>
<div class="analysis-section">
<h2>Security Analysis (90.0/100)</h2>
<div class="reasoning-text">The code is generally secure as it does not have any obvious security vulnerabilities such as injection flaws or insecure data handling. However, it does not validate the user object before returning it.</div>
<div class="recommendations">
<h3>Recommendations</h3>
<ul>
<li><span class="recommendation-text">Add validation to ensure the user object exists before returning it.</span><button class="fix-button" id="fix-security-analysis-0" onclick="fixWithAI('Security Analysis', 'Add validation to ensure the user object exists before returning it.', this)" data-category="Security Analysis" data-recommendation="Add validation to ensure the user object exists before returning it.">Fix with AI</button></li>
<li><span class="recommendation-text">Consider adding error handling for when the user object is not found.</span><button class="fix-button" id="fix-security-analysis-1" onclick="fixWithAI('Security Analysis', 'Consider adding error handling for when the user object is not found.', this)" data-category="Security Analysis" data-recommendation="Consider adding error handling for when the user object is not found.">Fix with AI</button></li>
<li><span class="recommendation-text">Ensure that the User entity does not expose sensitive information when serialized.</span><button class="fix-button" id="fix-security-analysis-2" onclick="fixWithAI('Security Analysis', 'Ensure that the User entity does not expose sensitive information when serialized.', this)" data-category="Security Analysis" data-recommendation="Ensure that the User entity does not expose sensitive information when serialized.">Fix with AI</button></li>
<li><span class="recommendation-text">Consider using a middleware to authenticate and attach the user to the request object.</span><button class="fix-button" id="fix-security-analysis-3" onclick="fixWithAI('Security Analysis', 'Consider using a middleware to authenticate and attach the user to the request object.', this)" data-category="Security Analysis" data-recommendation="Consider using a middleware to authenticate and attach the user to the request object.">Fix with AI</button></li>
<li><span class="recommendation-text">Ensure that the ExecutionContext is always used in a secure manner.</span><button class="fix-button" id="fix-security-analysis-4" onclick="fixWithAI('Security Analysis', 'Ensure that the ExecutionContext is always used in a secure manner.', this)" data-category="Security Analysis" data-recommendation="Ensure that the ExecutionContext is always used in a secure manner.">Fix with AI</button></li>
</ul></div>
</div>
<div class="analysis-section">
<h2>Bug Detection Analysis (90.0/100)</h2>
<div class="reasoning-text">The code seems to be mostly correct, but it assumes that the &#39;user&#39; property will always exist on the &#39;req&#39; object, which may not always be the case.</div>
<div class="recommendations">
<h3>Recommendations</h3>
<ul>
<li><span class="recommendation-text">Add a null check for &#39;req.user&#39; before returning it.</span><button class="fix-button" id="fix-bug-detection-analysis-0" onclick="fixWithAI('Bug Detection Analysis', 'Add a null check for &#39;req.user&#39; before returning it.', this)" data-category="Bug Detection Analysis" data-recommendation="Add a null check for &#39;req.user&#39; before returning it.">Fix with AI</button></li>
<li><span class="recommendation-text">Consider throwing an error if &#39;req.user&#39; is not defined.</span><button class="fix-button" id="fix-bug-detection-analysis-1" onclick="fixWithAI('Bug Detection Analysis', 'Consider throwing an error if &#39;req.user&#39; is not defined.', this)" data-category="Bug Detection Analysis" data-recommendation="Consider throwing an error if &#39;req.user&#39; is not defined.">Fix with AI</button></li>
<li><span class="recommendation-text">Add type checking for &#39;req.user&#39; to ensure it is an instance of &#39;User&#39;.</span><button class="fix-button" id="fix-bug-detection-analysis-2" onclick="fixWithAI('Bug Detection Analysis', 'Add type checking for &#39;req.user&#39; to ensure it is an instance of &#39;User&#39;.', this)" data-category="Bug Detection Analysis" data-recommendation="Add type checking for &#39;req.user&#39; to ensure it is an instance of &#39;User&#39;.">Fix with AI</button></li>
<li><span class="recommendation-text">Consider adding comments to explain what the code does.</span><button class="fix-button" id="fix-bug-detection-analysis-3" onclick="fixWithAI('Bug Detection Analysis', 'Consider adding comments to explain what the code does.', this)" data-category="Bug Detection Analysis" data-recommendation="Consider adding comments to explain what the code does.">Fix with AI</button></li>
<li><span class="recommendation-text">Consider adding unit tests to ensure the code behaves as expected.</span><button class="fix-button" id="fix-bug-detection-analysis-4" onclick="fixWithAI('Bug Detection Analysis', 'Consider adding unit tests to ensure the code behaves as expected.', this)" data-category="Bug Detection Analysis" data-recommendation="Consider adding unit tests to ensure the code behaves as expected.">Fix with AI</button></li>
</ul></div>
</div>
<div class="metrics-section">
<h2>File Metrics</h2>
<table class="metrics-table">
<tr><th>Metric</th><th>Value</th></tr>
<tr><td>Comment ratio</td><td>0.0</td></tr>
<tr><td>Lines of code</td><td>0</td></tr>
<tr><td>Number of methods</td><td>0</td></tr>
<tr><td>Number of classes</td><td>0</td></tr>
<tr><td>Cyclomatic complexity</td><td>0</td></tr>
<tr><td>Code complexity</td><td>UNKNOWN</td></tr>
</table></div>
<div style="text-align: center; margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; color: #666;">
<p>Analysis generated on 2025-08-03 12:58:17 by Code Guard</p>
<a href="../technical-report.html" class="back-link">← Back to Technical Report</a>
</div>
</div>
</body>
</html>
